!function($,t,s,o){var n=function(t,s){this.$ele=t,this.x=0,this.y=0,this.defaults={parent:"parent",randomPosition:!1,direction:"all",handler:!1,dragStart:function(t,s,o){},dragEnd:function(t,s,o){},dragMove:function(t,s,o){}},this.options=$.extend({},this.defaults,s)};n.prototype={run:function(){function o(){y=l.outerWidth(),w=l.outerHeight(),I=c.outerWidth(),x=c.outerHeight()}function n(){if(f){var t=parseInt(Math.random()*(y-I)),s=parseInt(Math.random()*(w-x));"x"==u.toLowerCase()?c.css({left:t}):"y"==u.toLowerCase()?c.css({top:s}):c.css({left:t,top:s})}}var e,i,a,r,p=this,c=this.$ele,f=this.options.randomPosition,u=this.options.direction,d=this.options.handler,l=this.options.parent,h=!1,g=this.options,m=0,v=0;c.find("*").not("img").mousedown(function(t){t.stopPropagation()}),l="parent"==l?c.parent():c.parents(l),d=d?c.find(d):c,l.css({position:"relative"}),c.css({position:"fixed"});var y=0,w=0,I=0,x=0;o(),f&&n(),$(t).resize(function(){o(),f&&n()}),d.mousedown(function(t){h=!0,m=t.pageX,v=t.pageY,p.x=c.position().left,p.y=c.position().top,a=c.position().left,r=c.position().top,c.addClass("on");var s=c.attr("data-nm");return g.dragStart(parseInt(c.css("left")),parseInt(c.css("top")),c,s),!1}),d.mouseup(function(t){t.originalEvent.type,c.css({left:a,top:r,opacity:0});var s=c.attr("data-nm");g.dragEnd(parseInt(c.css("left")),parseInt(c.css("top")),c,s),c.removeClass("on"),h=!1}),$(s).mousemove(function(t){if(e=p.x+t.pageX-m,i=p.y+t.pageY-v,h)g.dragMove(parseInt(c.css("left")),parseInt(c.css("top")),c);else if("INPUT"!=s.activeElement.tagName)return!1;"x"==u.toLowerCase()?function(){if(1==h)c.css({left:e}),e<0&&c.css({left:0}),e>y-I&&c.css({left:y-I})}():"y"==u.toLowerCase()?function(){if(1==h)c.css({top:i}),i<x&&c.css({top:0}),i>w-x&&c.css({top:w-x})}():function(){1==h&&(c.css({left:e,top:i}),e<0&&c.css({left:0}),e>y-I&&c.css({left:y-I}),i<0&&c.css({top:0}),i>w-x&&c.css({top:w-x}))}()})}},$.fn.myDrag=function(t){return new n(this,t).run(),this}}(jQuery,window,document);