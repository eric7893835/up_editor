!function($,o){function t(o){var t=this._initObj(o);this._init(t)}function n(o,t){var n=o;if(/image\/\w+/.test(n.type)){if(window.FileReader){var a=new FileReader;a.onloadend=function(o){$("#"+t).find("a").css({"background-image":"url("+o.target.result+")","background-repeat":"no-repeat","background-size":"100% 100%"}),i[t].buttonBgSrc=o.target.result;for(var n=e.length,a=0;a<n;a++)if(e[a].parent===t){e[a].style[".linkButton"]["background-image"]="url('../image/"+t+".png')",e[a].src=o.target.result;break}},a.readAsDataURL(n)}}else alert("请确保文件为图像类型")}var a=(window.UP.W.Util,window.UP.W.Ui,window.UP.W.Main);a.linkButton=a.linkButton||{};var i=a.linkButton,e=window.UP.Editor.page,d=[{label:"按钮文本",name:"buttonText"},{label:"按钮链接",name:"buttonLink"},{label:"背景颜色",name:"buttonFillColor"},{label:"背景图片",name:"buttonBgSrc"},{label:"字体颜色",name:"fontColor"},{label:"边框颜色",name:"buttonBorderColor"},{label:"高度",name:"buttonHeight"},{label:"边框厚度",name:"buttonBorderWidth"},{label:"边框弧度",name:"buttonBorderRadius"},{label:"字体大小",name:"fontSize"},{label:"是否分享",name:"isShare"},{label:"渐变",name:"linearGradientStyle"},{label:"&nbsp;",name:"linearGradientFrom"},{label:"&nbsp;",name:"linearGradientTo"},{label:"阴影",name:"boxShadowOffset"},{label:"&nbsp;",name:"boxShadow"},{label:"&nbsp;",name:"boxShadowColor"},{label:"背景透明",name:"buttonOpacity"}];a.setOpt(d),t.prototype={constructor:t,_init:function(o){this.domId=o.domId,this.inputValue=o.inputValue},_initObj:function(o){return{domId:o.attr("data-id"),inputValue:o.val()}}};var r=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;String.prototype.colorRgb=function(o){var t=this.toLowerCase();if(t&&r.test(t)){if(4===t.length){for(var n="#",a=1;a<4;a+=1)n+=t.slice(a,a+1).concat(t.slice(a,a+1));t=n}for(var i=[],a=1;a<7;a+=2)i.push(parseInt("0x"+t.slice(a,a+2)));return i.push(o),"rgba("+i.join(",")+")"}return t},$("#optionBody").on("blur","[id=changeWidth]",function(){var o=$(this).attr("data-w"),t=$(this).val(),n=$("#optionBody").find("[id='changeHeight']").val();a.resetLayoutDiv(o,t,n)}),$("#optionBody").on("click",".isShare",function(){var o=$("#"+$(this).data("id")).find("a").text(),t=$(this).data("id");if($(this).get(0).checked){var n=chrome.app.window.get("create");n?(n.close(),n.show()):chrome.app.window.create("../../html/shareEdit.html",{bounds:{width:480,height:320},resizable:!1,frame:"none"});for(var a=e.length,i=0;i<a;i++){if(e[i].parent===t){e[i].pageStr="<a class='linkButton' data-isShare='true'>"+o+"</a>";break}$("#"+t+" a").attr("data-isshare","true")}}else{for(var a=e.length,i=0;i<a;i++)if(e[i].parent===t){e[i].pageStr="<a class='linkButton' data-isShare='false'>"+o+"</a>";break}$("#"+t+" a").attr("data-isshare","false")}}),$("#optionBody").on("blur","[id=changeHeight]",function(){var o=$(this).attr("data-h"),t=$("#optionBody").find("[id='changeWidth']").val(),n=$(this).val(),i=2*$("#optionBody").find("[data-name='buttonBorderWidth']").val(),e=n-(i+1)+2;$("#optionBody").find("[data-name='buttonHeight']").val(e),$("#"+o).find("a").css({height:e+"px","line-height":e+"px"}),a.resetLayoutDiv(o,t,n)}),$("#optionBody").on("blur","[data-name=buttonText]",function(){var o=$(this),n=new t(o);$("#"+n.domId).find("a").text(n.inputValue),i[n.domId].buttonText=n.inputValue;var a=$('[data-id="'+n.domId+'"].isShare'),d="";d=a.get(0).checked?"<a class='linkButton' data-isShare='true'>"+n.inputValue+"</a>":"<a class='linkButton' data-isShare='flase'>"+n.inputValue+"</a>";for(var r=e.length,l=0;l<r;l++)if(e[l].parent===n.domId){e[l].pageStr=d;break}}),$("#optionBody").on("blur","[data-name=buttonLink]",function(){var o=$(this),n=new t(o);$("#"+n.domId).find("a").attr("href",n.inputValue),i[n.domId].buttonLink=n.inputValue;for(var a=e.length,d=0;d<a;d++)if(e[d].parent===n.domId){e[d].href=n.inputValue;break}}),$("#optionBody").on("blur","[data-name=buttonFillColor]",function(){var o=$(this),n=new t(o),a=$("#optionBody").find("[data-name='buttonOpacity']").val()/100,d=n.inputValue,r=d.colorRgb(a);$("#"+n.domId).find("a").css("background-color",r),i[n.domId].buttonFillColor=n.inputValue;for(var l=e.length,u=0;u<l;u++)if(e[u].parent===n.domId){e[u].style[".linkButton"]["background-color"]=n.inputValue;break}}),$("#optionBody").on("click","[data-name=buttonBgSrc]",function(){var o=$(this).attr("data-id");chrome.fileSystem.chooseEntry({type:"openWritableFile",accepts:[{description:"图片文件",mimeTypes:["image/png","image/jpeg","image/jpg"],extensions:["jpg","png"]}]},function(t){t.file(function(t){n(t,o)})})}),$("#optionBody").on("click","[data-control=clearBgImage]",function(){var o=$(this).prev().attr("data-id");$("#"+o).find("a").css({"background-image":""});for(var t=e.length,n=0;n<t;n++)if(e[n].parent===o){e[n].style[".linkButton"].backgroundImage="";break}}),$("#optionBody").on("blur","[data-name=fontColor]",function(){var o=$(this),n=new t(o);$("#"+n.domId).find("a").css("color",n.inputValue),i[n.domId].fontColor=n.inputValue;for(var a=e.length,d=0;d<a;d++)if(e[d].parent===n.domId){e[d].style[".linkButton"].color=n.inputValue;break}}),$("#optionBody").on("blur","[data-name=buttonBorderColor]",function(){var o=$(this),n=new t(o);$("#"+n.domId).find("a").css("border-color",n.inputValue),i[n.domId].buttonBorderColor=n.inputValue;for(var a=e.length,d=0;d<a;d++)if(e[d].parent===n.domId){e[d].style[".linkButton"]["border-color"]=n.inputValue;break}}),$("#optionBody").on("blur","[data-name=buttonHeight]",function(){var o=$(this),n=new t(o),d=$("#optionBody").find("[id='changeWidth']").val(),r=2*$("#optionBody").find("[data-name='buttonBorderWidth']").val()-2,l=n.inputValue,u=parseInt(l)+parseInt(r);a.resetLayoutDiv(n.domId,d,u),$("#"+n.domId).find("a").css({height:n.inputValue+"px","line-height":n.inputValue+"px"}),i[n.domId].buttonHeight=n.inputValue;for(var p=e.length,s=0;s<p;s++)if(e[s].parent===n.domId){e[s].style[".linkButton"].height=n.inputValue+"px",e[s].style[".linkButton"]["line-height"]=n.inputValue+"px";break}}),$("#optionBody").on("blur","[data-name=buttonBorderWidth]",function(){var o=$(this),n=new t(o),d=$("#optionBody").find("[id='changeWidth']").val(),r=$("#optionBody").find("[data-name='buttonHeight']").val(),l=2*n.inputValue,u=parseInt(r)+parseInt(l);$("#"+n.domId).find("a").css("border-width",n.inputValue+"px"),$("#"+n.domId).find("a").css({height:r+"px","line-height":r+"px"}),a.resetLayoutDiv(n.domId,d,u),i[n.domId].buttonBorderWidth=n.inputValue;for(var p=e.length,s=0;s<p;s++)if(e[s].parent===n.domId){e[s].style[".linkButton"]["border-width"]=n.inputValue+"px";break}}),$("#optionBody").on("blur","[data-name=fontSize]",function(){var o=$(this),n=new t(o);$("#"+n.domId).find("a").css("font-size",n.inputValue+"px"),i[n.domId].fontSize=n.inputValue;for(var a=e.length,d=0;d<a;d++)if(e[d].parent===n.domId){e[d].style[".linkButton"]["font-size"]=n.inputValue+"px";break}}),$("#optionBody").on("blur","[data-name=buttonBorderRadius]",function(){var o=$(this),n=new t(o);$("#"+n.domId).find("a").css("border-radius",n.inputValue+"px"),i[n.domId].buttonBorderRadius=n.inputValue;for(var a=e.length,d=0;d<a;d++)if(e[d].parent===n.domId){e[d].style[".linkButton"]["border-radius"]=n.inputValue+"px";break}}),$("#optionBody").on("change","[data-name=linearGradientStyle]",function(){var o=$("#optionBody").find("[data-control='linearGradientFrom']").val(),n=$("#optionBody").find("[data-control='linearGradientTo']").val(),a=$(this),d=new t(a);i[d.domId].linearGradientStyle=d.inputValue;for(var r=e.length,l=0;l<r;l++)if(e[l].parent===d.domId){1==$(this).val()?e[l].style[".linkButton"].background="linear-gradient("+o+", "+n+")":2==$(this).val()?e[l].style[".linkButton"].background="linear-gradient(to right, "+o+", "+n+")":3==$(this).val()&&(e[l].style[".linkButton"].background="linear-gradient(to bottom right, "+o+", "+n+")");break}if(!o||!n)return!1;if(1==$(this).val())$("#"+d.domId).find("a").css({background:"linear-gradient("+o+", "+n+")"});else if(2==$(this).val())$("#"+d.domId).find("a").css({background:"linear-gradient(to right, "+o+", "+n+")"});else if(3==$(this).val())$("#"+d.domId).find("a").css({background:"linear-gradient(to bottom right, "+o+", "+n+")"});else{var u=$("#optionBody").find("[data-name='buttonFillColor']").val(),p=$("#optionBody").find("[data-name='buttonOpacity']").val()/100,s=u.colorRgb(p);$("#"+d.domId).find("a").css("background",s)}}),$("#optionBody").on("blur","[data-control=linearGradientFrom]",function(){var o=$("#optionBody").find("[data-name='linearGradientStyle']").val(),n=$("#optionBody").find("[data-control='linearGradientTo']").val(),a=$(this),d=new t(a);i[d.domId].linearGradientFrom=d.inputValue;for(var r=e.length,l=0;l<r;l++)if(e[l].parent===d.domId){1==o?e[l].style[".linkButton"].background="linear-gradient("+d.inputValue+", "+n+")":2==o?e[l].style[".linkButton"].background="linear-gradient(to right, "+d.inputValue+", "+n+")":3==o&&(e[l].style[".linkButton"].background="linear-gradient(to bottom right, "+d.inputValue+", "+n+")");break}if(!d.inputValue||!n)return!1;if(1==o)$("#"+d.domId).find("a").css({background:"linear-gradient("+d.inputValue+", "+n+")"});else if(2==o)$("#"+d.domId).find("a").css({background:"linear-gradient(to right, "+d.inputValue+", "+n+")"});else if(3==o)$("#"+d.domId).find("a").css({background:"linear-gradient(to bottom right, "+d.inputValue+", "+n+")"});else{var u=$("#optionBody").find("[data-name='buttonFillColor']").val(),p=$("#optionBody").find("[data-name='buttonOpacity']").val()/100,s=u.colorRgb(p);$("#"+d.domId).find("a").css("background",s)}}),$("#optionBody").on("blur","[data-control=linearGradientTo]",function(){var o=$("#optionBody").find("[data-name='linearGradientStyle']").val(),n=$("#optionBody").find("[data-control='linearGradientFrom']").val(),a=$(this),d=new t(a);i[d.domId].linearGradientTo=d.inputValue;for(var r=e.length,l=0;l<r;l++)if(e[l].parent===d.domId){if(e[l].linearGradientTo=d.inputValue,e[l].parent===d.domId){1==o?e[l].style[".linkButton"].background="linear-gradient("+n+", "+d.inputValue+")":2==o?e[l].style[".linkButton"].background="linear-gradient(to right, "+n+", "+d.inputValue+")":3==o&&(e[l].style[".linkButton"].background="linear-gradient(to bottom right, "+n+", "+d.inputValue+")");break}break}if(!n||!d.inputValue)return!1;if(1==o)$("#"+d.domId).find("a").css({background:"linear-gradient("+n+", "+d.inputValue+")"});else if(2==o)$("#"+d.domId).find("a").css({background:"linear-gradient(to right, "+n+", "+d.inputValue+")"});else if(3==o)$("#"+d.domId).find("a").css({background:"linear-gradient(to bottom right, "+n+", "+d.inputValue+")"});else{var u=$("#optionBody").find("[data-name='buttonFillColor']").val(),p=$("#optionBody").find("[data-name='buttonOpacity']").val()/100,s=u.colorRgb(p);$("#"+d.domId).find("a").css("background",s)}}),$("#optionBody").on("blur","[data-control=boxShadowX]",function(){var o=$(this),n=new t(o),a=n.inputValue+"px",d=$("#optionBody").find("[data-control='boxShadowY']").val()+"px",r=$("#optionBody").find("[data-name='boxShadow']").val()+"px",l=$("#optionBody").find("[data-control='boxShadowColor']").val();i[n.domId].boxShadowX=n.inputValue;for(var u=e.length,p=0;p<u;p++)if(e[p].parent===n.domId){e[p].style[".linkButton"]["box-shadow"]=" "+a+"  "+d+" "+r+" "+l+" ";break}n.inputValue&&d&&r&&l&&$("#"+n.domId).find("a").css({"box-shadow":" "+a+" "+d+" "+r+" "+l+" "})}),$("#optionBody").on("blur","[data-control=boxShadowY]",function(){var o=$(this),n=new t(o),a=$("#optionBody").find("[data-control='boxShadowX']").val()+"px",d=n.inputValue+"px",r=$("#optionBody").find("[data-name='boxShadow']").val()+"px",l=$("#optionBody").find("[data-control='boxShadowColor']").val();i[n.domId].boxShadowY=n.inputValue;for(var u=e.length,p=0;p<u;p++)if(e[p].parent===n.domId){e[p].style[".linkButton"]["box-shadow"]=" "+a+"  "+d+" "+r+" "+l+" ";break}a&&n.inputValue&&r&&l&&$("#"+n.domId).find("a").css({"box-shadow":" "+a+" "+d+" "+r+" "+l+" "})}),$("#optionBody").on("blur","[data-control=boxShadowR]",function(){var o=$(this),n=new t(o),a=$("#optionBody").find("[data-control='boxShadowX']").val()+"px",d=$("#optionBody").find("[data-control='boxShadowY']").val()+"px",r=n.inputValue+"px",l=$("#optionBody").find("[data-control='boxShadowColor']").val();i[n.domId].boxShadowR=n.inputValue;for(var u=e.length,p=0;p<u;p++)if(e[p].parent===n.domId){e[p].style[".linkButton"]["box-shadow"]=" "+a+"  "+d+" "+r+" "+l+" ";break}a&&d&&n.inputValue&&l&&$("#"+n.domId).find("a").css({"box-shadow":" "+a+" "+d+" "+r+" "+l+" "})}),$("#optionBody").on("blur","[data-control=boxShadowColor]",function(){var o=$(this),n=new t(o),a=$("#optionBody").find("[data-control='boxShadowX']").val()+"px",d=$("#optionBody").find("[data-control='boxShadowY']").val()+"px",r=$("#optionBody").find("[data-name='boxShadow']").val()+"px",l=n.inputValue;i[n.domId].boxShadowColor=n.inputValue;for(var u=e.length,p=0;p<u;p++)if(e[p].parent===n.domId){e[p].style[".linkButton"]["box-shadow"]=" "+a+"  "+d+" "+r+" "+l+" ";break}a&&d&&r&&n.inputValue&&$("#"+n.domId).find("a").css({"box-shadow":" "+a+" "+d+" "+r+" "+l+" "})}),$("#optionBody").on("input","[data-control=buttonOpacity]",function(){var o=$(this),n=new t(o),a=n.inputValue/100,d=$("#optionBody").find("[data-name='buttonFillColor']").val(),r=d.colorRgb(a);$("#"+n.domId).find("a").css("background-color",r),i[n.domId].buttonOpacity=n.inputValue;for(var l=e.length,u=0;u<l;u++)if(e[u].parent===n.domId){e[u].style[".linkButton"]["background-color"]=r;break}}),define(function(){return{options:d,dom:"<a class='up-editor-dom up-editor-button' data-minH = '42' data-isShare='flase' class='linkButton'> 去银联钱包查看 </a><div class=\"widgetSelectMask\"><span class=\"widgetMaskClose\"></span></div>",afterRender:function(o){a.setResize(o,function(o,t,n){setTimeout(function(){a.layoutOpts[o].width=t,a.layoutOpts[o].height=n},500)}),i[o]={buttonText:"去银联钱包查看",buttonLink:"www.example.com",buttonFillColor:"#7AD80B",buttonBgSrc:null,fontColor:"#fff",buttonBorderColor:"#969696",buttonBorderWidth:"1",buttonBorderRadius:"5",fontSize:"16",buttonHeight:"42",linearGradientStyle:"0",linearGradientFrom:"#fff",linearGradientTo:"#fff",boxShadowX:"0",boxShadowY:"0",boxShadowR:"0",boxShadowColor:"#fff",buttonOpacity:"100"};var t={parent:o,pageStr:"<a class='linkButton'>去银联钱包查看</a>",style:{".linkButton":{width:"100%",display:"block",padding:0,outline:"none","text-align":"center","text-decoration":"none",height:"42px","background-color":"rgb(122, 216, 11)",background:"","background-image":"","background-repeat":"no-repeat","background-size":"100% 100%","border-radius":"5px",border:"1px solid #969696","font-size":"16px","line-height":"42px",color:"#fff","box-shadow":"0 0 0 #fff"}},href:"www.example.com"};e.push(t),a.setSelected(o,function(o){setTimeout(function(){var t={buttonText:i[o].buttonText,buttonLink:i[o].buttonLink,buttonFillColor:i[o].buttonFillColor,buttonBgSrc:"",fontColor:i[o].fontColor,buttonBorderColor:i[o].buttonBorderColor,buttonHeight:i[o].buttonHeight,buttonBorderWidth:i[o].buttonBorderWidth,buttonBorderRadius:i[o].buttonBorderRadius,fontSize:i[o].fontSize,linearGradientStyle:i[o].linearGradientStyle,linearGradientFrom:i[o].linearGradientFrom,linearGradientTo:i[o].linearGradientTo,boxShadowX:i[o].boxShadowX,boxShadowY:i[o].boxShadowY,boxShadowR:i[o].boxShadowR,boxShadowColor:i[o].boxShadowColor,buttonOpacity:i[o].buttonOpacity};"true"==$("#"+o+" a").attr("data-isshare")&&$("#optionBody").find("[data-control='isShare']").attr("checked",!0);for(var n in t)!function(o,t){"buttonFillColor"===o||"fontColor"===o||"buttonBorderColor"===o||"boxShadowColor"===o||"linearGradientFrom"===o||"linearGradientTo"===o?($("#optionBody").find("[data-control = "+o+" ]").val(t),$("#optionBody").find("[data-control = "+o+" ]").next("span").find("span").css("background-color",t)):"buttonOpacity"===o?($("#optionBody").find("[data-control = buttonOpacity]").val(t),$("#optionBody").find("[data-control = buttonRange]").val(t)):$("#optionBody").find("[data-control = "+o+" ]").val(t)}(n,t[n])},300)})}}})}(window.Zepto||window.jQuery,window.UP=window.UP||{});