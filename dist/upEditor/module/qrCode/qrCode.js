!function($,t){var e=(window.UP.W.Util,window.UP.W.Ui,window.UP.W.Main);e.qrCode=e.qrCode||{};var i=e.qrCode,a=window.UP.Editor.page,n=[{label:"链接地址",name:"qrLink"},{label:"Logo",name:"qrImg"}];$("#optionBody").on("input","[data-name=qrLink]",function(){var t=$(this).attr("data-id"),e=$(this).val();clearTimeout(null),setTimeout(function(){i[t]._htOption.text=e,i[t]._htOption.imgDataUrl?i[t].makeCode(e,i[t]._htOption.imgDataUrl):i[t].makeCode(e);for(var n=a.length,o=0;o<n;o++)if(a[o].parent===t){a[o].href=e,a[o].src=i[t].getDataUrl();break}},300)}),$("#optionBody").on("click","[data-name=qrImg]",function(){var t=$(this).attr("data-id"),e=i[t]._htOption.text;chrome.fileSystem.chooseEntry({type:"openWritableFile",accepts:[{description:"图片文件",mimeTypes:["image/png","image/jpeg","image/jpg"],extensions:["jpg","png"]}]},function(n){n.file(function(n){var o=new FileReader;o.onload=function(n){i[t]._htOption.imgDataUrl=n.target.result,i[t].makeCode(e,n.target.result);for(var o=a.length,r=0;r<o;r++)if(a[r].parent===t){setTimeout(function(){a[r].logo=n.target.result,a[r].src=i[t].getDataUrl()},500);break}},o.readAsDataURL(n)})})}),define(function(){return{options:n,dom:'<div style="width:100%;height:100%;" data-minH="375" class="qrCode"></div><div class="widgetSelectMask"><span class="widgetMaskClose"></span></div>',afterRender:function(t){i[t]=new QRCode($("#"+t).find(".qrCode")[0],{text:"www.example.com",width:375,height:375});var n={parent:t,pageStr:"<img class='qrCodeImg'/>",style:{".qrCodeImg":{}},src:i[t].getDataUrl(),logo:null,href:"www.example.com"};a.push(n),e.setResize(t,function(t,n,o,r){(n<30||o<30)&&(n=30,o=30),r?o=n:n=o,$("#"+t).css({width:n,height:o}),setTimeout(function(){e.layoutOpts[t].width=n,e.layoutOpts[t].height=o},500),$("#changeHeight").val(o),$("#changeWidth").val(n),i[t]._htOption.width=n,i[t]._htOption.height=o,e.resetLayoutDiv(t,n,o);var d=i[t]._htOption.text;i[t]._htOption.imgDataUrl?i[t].makeCode(d,i[t]._htOption.imgDataUrl):i[t].makeCode(d);for(var l=a.length,s=0;s<l;s++)if(a[s].parent===t){a[s].src=i[t].getDataUrl();break}}),e.setSelected(t,function(t){var e=i[t]._htOption.text;setTimeout(function(){$("#optionBody").find("[data-name=qrLink]").val(e)},500)})}}})}(window.Zepto||window.jQuery,window.UP=window.UP||{});